<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Wishlist</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6e9de4;
            --accent-color: #ff6b6b;
            --background-color: #ffffff;
            --card-background: #f8f9fa;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --input-background: #ffffff;
        }

        .dark-mode {
            --primary-color: #6e9de4;
            --secondary-color: #4a6fa5;
            --accent-color: #ff8e8e;
            --background-color: #1a1a2e;
            --card-background: #16213e;
            --text-color: #e6e6e6;
            --border-color: #2d4059;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --input-background: #2d4059;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--card-background);
            border-radius: 10px;
            box-shadow: 0 4px 15px var(--shadow-color);
            margin-bottom: 30px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo i {
            font-size: 2.5rem;
            color: var(--accent-color);
        }

        .logo h1 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle {
            background: var(--card-background);
            border: 2px solid var(--border-color);
            width: 60px;
            height: 30px;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 0 5px;
        }

        .toggle-circle {
            position: absolute;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background-color: var(--primary-color);
            transition: transform 0.3s;
        }

        .dark-mode .toggle-circle {
            transform: translateX(30px);
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .login-btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--shadow-color);
        }

        .add-btn {
            background: linear-gradient(45deg, #4ecdc4, #1a936f);
            color: white;
            display: none;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--shadow-color);
        }

        .logout-btn {
            background: var(--card-background);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            display: none;
        }

        .logout-btn:hover {
            background: var(--border-color);
        }

        .wishlist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .wishlist-item {
            background: var(--card-background);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px var(--shadow-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        .wishlist-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow-color);
        }

        .item-image {
            height: 200px;
            overflow: hidden;
            position: relative;
        }

        .item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .wishlist-item:hover .item-image img {
            transform: scale(1.05);
        }

        .item-details {
            padding: 20px;
        }

        .item-date {
            font-size: 0.85rem;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }

        .item-description {
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .item-link {
            display: block;
            text-align: center;
            padding: 10px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .item-link:hover {
            opacity: 0.9;
        }

        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10;
        }

        .wishlist-item:hover .delete-btn {
            opacity: 1;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--card-background);
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-btn {
            float: right;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
        }

        h2 {
            margin: 20px 0;
            color: var(--primary-color);
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
            background-color: var(--input-background);
            color: var(--text-color);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #4ecdc4, #1a936f);
            color: white;
            font-size: 1.1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .submit-btn:hover {
            opacity: 0.9;
        }

        .image-preview {
            width: 100%;
            height: 200px;
            border: 2px dashed var(--border-color);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .status-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            display: none;
        }

        .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-color);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .wishlist-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .header-controls {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-gift"></i>
                <h1>My Wishlist</h1>
            </div>
            <div class="header-controls">
                <div class="theme-toggle" id="themeToggle">
                    <div class="toggle-circle"></div>
                </div>
                <button class="login-btn" id="loginBtn"><i class="fas fa-lock"></i> Login</button>
                <button class="add-btn" id="addBtn"><i class="fas fa-plus"></i> Add Item</button>
                <button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </header>

        <div id="statusMessage" class="status-message"></div>

        <div class="wishlist-grid" id="wishlistGrid">
            <!-- Wishlist items will be dynamically added here -->
        </div>

        <!-- Login Modal -->
        <div class="modal" id="loginModal">
            <div class="modal-content">
                <span class="close-btn" id="closeLogin">&times;</span>
                <h2>Admin Login</h2>
                <div class="form-group">
                    <label for="pin">Enter PIN:</label>
                    <input type="password" id="pin" placeholder="Enter secret PIN">
                </div>
                <button class="submit-btn" id="submitLogin">Login</button>
            </div>
        </div>

        <!-- Add Item Modal -->
        <div class="modal" id="addItemModal">
            <div class="modal-content">
                <span class="close-btn" id="closeAddItem">&times;</span>
                <h2>Add New Wishlist Item</h2>
                
                <div class="form-group">
                    <label for="imageSource">Image Source:</label>
                    <select id="imageSource">
                        <option value="url">Image URL</option>
                        <option value="upload">Upload Image</option>
                    </select>
                </div>
                
                <div class="form-group" id="imageUrlGroup">
                    <label for="imageUrl">Image URL:</label>
                    <input type="text" id="imageUrl" placeholder="Paste image URL here">
                </div>
                
                <div class="form-group" id="imageUploadGroup" style="display: none;">
                    <label for="imageUpload">Upload Image:</label>
                    <input type="file" id="imageUpload" accept="image/*">
                    <div class="image-preview" id="imagePreview">
                        <span>Preview will appear here</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="itemLink">Item Link:</label>
                    <input type="text" id="itemLink" placeholder="Paste link to the item">
                </div>
                <div class="form-group">
                    <label for="itemDescription">Description:</label>
                    <textarea id="itemDescription" placeholder="Describe the item"></textarea>
                </div>
                <button class="submit-btn" id="submitItem">Add to Wishlist</button>
            </div>
        </div>

        <footer>
            <p>Created with ❤️ | Birthday & Christmas Wishlist | Data stored on GitHub</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const themeToggle = document.getElementById('themeToggle');
            const loginBtn = document.getElementById('loginBtn');
            const addBtn = document.getElementById('addBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const wishlistGrid = document.getElementById('wishlistGrid');
            const loginModal = document.getElementById('loginModal');
            const addItemModal = document.getElementById('addItemModal');
            const closeLogin = document.getElementById('closeLogin');
            const closeAddItem = document.getElementById('closeAddItem');
            const submitLogin = document.getElementById('submitLogin');
            const submitItem = document.getElementById('submitItem');
            const imageSource = document.getElementById('imageSource');
            const imageUrlGroup = document.getElementById('imageUrlGroup');
            const imageUploadGroup = document.getElementById('imageUploadGroup');
            const imageUpload = document.getElementById('imageUpload');
            const imagePreview = document.getElementById('imagePreview');
            const statusMessage = document.getElementById('statusMessage');
            
            // Check for saved theme preference
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
            }
            
            // Initialize empty wishlist
            let wishlistItems = [];
            
            // Hardcoded GitHub settings with encrypted credentials
            // In a real implementation, you would use a more secure encryption method
            const githubSettings = {
                username: 'Bossxer', // Replace with your GitHub username
                token: 'jks_kGcFOu6Av8yW5oppwfA7qCUb9z6FfJ2fECaz', // Replace with your encrypted GitHub token
                repo: 'wishlist-data' // Replace with your repository name
            };
            
            // Simple Caesar cipher decryption function
            function caesarDecrypt(str, shift = 3) {
                return str.replace(/[a-zA-Z]/g, function(char) {
                    const base = char <= 'Z' ? 65 : 97;
                    return String.fromCharCode((char.charCodeAt(0) - base - shift + 26) % 26 + base);
                });
            }
            
            // Decrypt the GitHub token (this is just a simple example)
            // In a real implementation, you would use a more secure method
            githubSettings.token = caesarDecrypt(githubSettings.token);
            
            // Check if user is logged in (from sessionStorage)
            let isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true';
            updateUI();
            
            // Try to load data from GitHub
            loadFromGitHub();
            
            // Event Listeners
            themeToggle.addEventListener('click', toggleDarkMode);
            loginBtn.addEventListener('click', () => loginModal.style.display = 'flex');
            addBtn.addEventListener('click', () => addItemModal.style.display = 'flex');
            logoutBtn.addEventListener('click', logout);
            
            closeLogin.addEventListener('click', () => loginModal.style.display = 'none');
            closeAddItem.addEventListener('click', () => addItemModal.style.display = 'none');
            
            imageSource.addEventListener('change', function() {
                if (this.value === 'url') {
                    imageUrlGroup.style.display = 'block';
                    imageUploadGroup.style.display = 'none';
                } else {
                    imageUrlGroup.style.display = 'none';
                    imageUploadGroup.style.display = 'block';
                }
            });
            
            imageUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imagePreview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            submitLogin.addEventListener('click', function() {
                const pin = document.getElementById('pin').value;
                if (pin === '1234') { // Simple PIN check
                    isLoggedIn = true;
                    sessionStorage.setItem('isLoggedIn', 'true');
                    updateUI();
                    loginModal.style.display = 'none';
                    showStatus('Login successful!', 'success');
                } else {
                    showStatus('Incorrect PIN. Please try again.', 'error');
                }
            });
            
            submitItem.addEventListener('click', function() {
                const imageUrl = document.getElementById('imageUrl').value;
                const itemLink = document.getElementById('itemLink').value;
                const description = document.getElementById('itemDescription').value;
                
                if ((imageUrl || imageUpload.files.length > 0) && itemLink && description) {
                    let imageSrc = imageUrl;
                    
                    // If uploading an image, convert to data URL
                    if (imageSource.value === 'upload' && imageUpload.files.length > 0) {
                        const file = imageUpload.files[0];
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            imageSrc = e.target.result;
                            addItemToWishlist(imageSrc, itemLink, description);
                        };
                        reader.readAsDataURL(file);
                    } else {
                        addItemToWishlist(imageSrc, itemLink, description);
                    }
                } else {
                    showStatus('Please fill in all fields.', 'error');
                }
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === loginModal) {
                    loginModal.style.display = 'none';
                }
                if (event.target === addItemModal) {
                    addItemModal.style.display = 'none';
                }
            });
            
            // Functions
            function toggleDarkMode() {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('darkMode', 'enabled');
                } else {
                    localStorage.setItem('darkMode', 'disabled');
                }
            }
            
            function updateUI() {
                if (isLoggedIn) {
                    loginBtn.style.display = 'none';
                    addBtn.style.display = 'block';
                    logoutBtn.style.display = 'block';
                } else {
                    loginBtn.style.display = 'block';
                    addBtn.style.display = 'none';
                    logoutBtn.style.display = 'none';
                }
                renderWishlist(); // Re-render to show/hide delete buttons
            }
            
            function logout() {
                isLoggedIn = false;
                sessionStorage.setItem('isLoggedIn', 'false');
                updateUI();
                showStatus('You have been logged out.', 'success');
            }
            
            function addItemToWishlist(imageSrc, itemLink, description) {
                // Add new item to wishlist
                const newItem = {
                    id: Date.now(), // Use timestamp as ID
                    image: imageSrc,
                    date: new Date().toISOString().split('T')[0],
                    description: description,
                    link: itemLink
                };
                
                wishlistItems.push(newItem);
                renderWishlist();
                
                // Clear form and close modal
                document.getElementById('imageUrl').value = '';
                document.getElementById('itemLink').value = '';
                document.getElementById('itemDescription').value = '';
                imagePreview.innerHTML = '<span>Preview will appear here</span>';
                imageUpload.value = '';
                addItemModal.style.display = 'none';
                
                // Save to GitHub
                saveToGitHub();
            }
            
            function deleteItem(id) {
                if (confirm("Are you sure you want to delete this item?")) {
                    wishlistItems = wishlistItems.filter(item => item.id !== id);
                    renderWishlist();
                    saveToGitHub();
                    showStatus('Item deleted successfully!', 'success');
                }
            }
            
            function renderWishlist() {
                wishlistGrid.innerHTML = '';
                
                if (wishlistItems.length === 0) {
                    wishlistGrid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; padding: 40px;">No wishlist items yet. Login and add some!</p>';
                    return;
                }
                
                wishlistItems.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.classList.add('wishlist-item');
                    
                    itemElement.innerHTML = `
                        ${isLoggedIn ? `<button class="delete-btn" onclick="deleteItem(${item.id})"><i class="fas fa-times"></i></button>` : ''}
                        <div class="item-image">
                            <img src="${item.image}" alt="Wishlist item" onerror="this.src='https://images.unsplash.com/photo-1546868871-7041f2a55e12?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80'">
                        </div>
                        <div class="item-details">
                            <div class="item-date">Added: ${item.date}</div>
                            <p class="item-description">${item.description}</p>
                            <a href="${item.link}" target="_blank" class="item-link">View Item</a>
                        </div>
                    `;
                    
                    wishlistGrid.appendChild(itemElement);
                });
            }
            
            function showStatus(message, type) {
                statusMessage.textContent = message;
                statusMessage.className = 'status-message';
                statusMessage.classList.add(`status-${type}`);
                statusMessage.style.display = 'block';
                
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 3000);
            }
            
            async function saveToGitHub() {
                try {
                    // Check if file exists to get its SHA
                    let sha = null;
                    try {
                        const checkResponse = await fetch(
                            `https://api.github.com/repos/${githubSettings.username}/${githubSettings.repo}/contents/wishlist.json`,
                            {
                                headers: {
                                    'Authorization': `token ${githubSettings.token}`,
                                    'Accept': 'application/vnd.github.v3+json'
                                }
                            }
                        );
                        
                        if (checkResponse.ok) {
                            const data = await checkResponse.json();
                            sha = data.sha;
                        }
                    } catch (error) {
                        // File doesn't exist yet, which is fine
                    }
                    
                    // Create or update the file
                    const content = btoa(unescape(encodeURIComponent(JSON.stringify(wishlistItems, null, 2))));
                    const response = await fetch(
                        `https://api.github.com/repos/${githubSettings.username}/${githubSettings.repo}/contents/wishlist.json`,
                        {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${githubSettings.token}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                message: 'Update wishlist',
                                content: content,
                                sha: sha
                            })
                        }
                    );
                    
                    if (response.ok) {
                        showStatus('Wishlist saved to GitHub successfully!', 'success');
                    } else {
                        const error = await response.json();
                        showStatus('Error saving to GitHub: ' + error.message, 'error');
                    }
                } catch (error) {
                    showStatus('Error saving to GitHub: ' + error.message, 'error');
                }
            }
            
            async function loadFromGitHub() {
                try {
                    const response = await fetch(
                        `https://api.github.com/repos/${githubSettings.username}/${githubSettings.repo}/contents/wishlist.json`,
                        {
                            headers: {
                                'Authorization': `token ${githubSettings.token}`,
                                'Accept': 'application/vnd.github.v3+json'
                            }
                        }
                    );
                    
                    if (response.ok) {
                        const data = await response.json();
                        const content = decodeURIComponent(escape(atob(data.content)));
                        wishlistItems = JSON.parse(content);
                        renderWishlist();
                        showStatus('Wishlist loaded from GitHub!', 'success');
                    } else if (response.status === 404) {
                        // File doesn't exist yet, which is fine
                        showStatus('No existing wishlist found on GitHub. Add items to create one.', 'success');
                        renderWishlist();
                    } else {
                        const error = await response.json();
                        showStatus('Error loading from GitHub: ' + error.message, 'error');
                    }
                } catch (error) {
                    showStatus('Error loading from GitHub: ' + error.message, 'error');
                }
            }

            // Make deleteItem function available globally
            window.deleteItem = deleteItem;
        });
    </script>
</body>
</html>